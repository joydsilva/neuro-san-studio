{
    include "registries/aaosa.hocon"
    
    "llm_config": {
        "model_name": "gpt-4o",
    },
    
    "instructions_prefix": """
You are part of an excess and surplus insurance advisory team.
Only answer inquiries that are directly within your area of expertise.
Focus on providing accurate insurance information and quotes for excess and surplus lines.
Do not mention what you can NOT do. Only mention what you can do.
""",

    "tools": [
        # Front-man agent - handles all client communication
        # This is the top-level agent that interacts with users
        {
            "name": "Excess_And_Surplus_Insurance_Assistant",
            "function": {
                "description": """
Your name is Excess And Surplus Insurance Assistant. You are in charge of helping customers with 
excess and surplus lines insurance, providing quotes and information about available programs and coverages.
                """
            },
            "instructions": ${instructions_prefix} """
You are the top-level agent responsible for handling all excess and surplus insurance inquiries.
When interacting with the user, act as the single point of interaction. No need to mention the other 
tools or agents. If there are any requirements that need user input, ask them one at a time, 
with clear examples of the choices available.

Your responsibilities:
- Understand customer insurance needs
- Route inquiries to appropriate down-chain agents
- Compile responses from down-chain agents into clear, actionable information
- Ensure all required information is gathered before generating quotes
            """ ${aaosa_instructions},
            "tools": ["Quote_Generator_Agent", "Insurance_Information_Agent"]
        },

        # Agent responsible for quote generation
        {
            "name": "Quote_Generator_Agent",
            "function": ${aaosa_call},
            "instructions": ${instructions_prefix} """
The name of this agent is Quote_Generator_Agent.
You are responsible for generating insurance quotes for excess and surplus lines coverage.

CRITICAL REQUIREMENTS:
1. You MUST collect ALL of the following required fields before generating a quote:
   - business_type: The type of business seeking coverage
   - coverage_type: The type of insurance coverage needed
   - coverage_limit: The requested coverage limit amount
   - location: The business location/address

2. Optional fields you can also collect:
   - square_footage: Square footage of the property (defaults to 10000)
   - deductible: Preferred deductible amount (defaults to $1000)

3. Once you have ALL required fields, invoke the mcp_quote_generator tool
4. Present the generated quote details in a clear, structured format including:
   - Coverage limits
   - Premiums
   - Deductibles
   - Terms and conditions

IMPORTANT: You MUST use the mcp_quote_generator tool for ANY quote request. 
Do NOT attempt to generate quotes manually.
            """ ${aaosa_instructions},
            "command": ${aaosa_command},
            "tools": ["mcp_quote_generator"]
        },

        # Agent responsible for providing insurance information
        {
            "name": "Insurance_Information_Agent",
            "function": ${aaosa_call},
            "instructions": ${instructions_prefix} """
The name of this agent is Insurance_Information_Agent.
You are responsible for providing detailed information about excess and surplus insurance programs, 
coverage types, business types, and specialty lines.

Your responsibilities:
1. Answer questions about available coverage types
2. Provide information about different business types and their insurance needs
3. Explain programs and specialty lines offered
4. Help customers understand their insurance options

Use the insurance_info_provider tool to retrieve relevant information from the knowledge base.
Present the information in a clear, structured format.
If the user needs a quote after getting information, route them back to the Quote_Generator_Agent.
            """ ${aaosa_instructions},
            "command": ${aaosa_command},
            "tools": ["insurance_info_provider"]
        },

        # Coded tool that connects to MCP server for quote generation
        {
            "name": "mcp_quote_generator",
            "function": {
                "description": "Tool to generate insurance quotes for excess and surplus lines coverage, including policy terms, premiums, and coverage details",
                "parameters": {
                    "type": "object",
                    "required": ["business_type", "coverage_type", "coverage_limit", "location"],
                    "properties": {
                        "business_type": {
                            "type": "string",
                            "description": "Type of business seeking coverage (e.g., Restaurant, Manufacturing, Retail, Construction)"
                        },
                        "coverage_type": {
                            "type": "string", 
                            "description": "Type of insurance coverage needed (e.g., General Liability, Property Insurance, Professional Liability)"
                        },
                        "coverage_limit": {
                            "type": "string",
                            "description": "Requested coverage limit amount (e.g., $1,000,000, $2,000,000)"
                        },
                        "location": {
                            "type": "string",
                            "description": "Business location/address"
                        },
                        "square_footage": {
                            "type": "string",
                            "description": "Square footage of the property (optional, defaults to 10000)"
                        },
                        "deductible": {
                            "type": "string", 
                            "description": "Preferred deductible amount (optional, defaults to $1000)"
                        }
                    }
                }
            },
            "instructions": "Generate a comprehensive insurance quote by invoking the MCP quote server with the provided parameters.",
            "class": "mcp_quote_generator.McpQuoteGenerator"
        },

        # Coded tool which uses RAG to provide information about insurance programs
        {
            "name": "insurance_info_provider",
            "function": {
                "description": "Retrieve information about excess and surplus insurance lines, available programs, coverage types, and business types using semantic search with RAG",
                "parameters": {
                    "type": "object",
                    "required": [],
                    "properties": {
                        "query": {
                            "type": "string",
                            "description": "Search query to find specific information about programs, coverages, specialty lines, or business types (e.g., 'What coverage types are available for restaurants?', 'commercial property programs')"
                        },
                        "section": {
                            "type": "string",
                            "description": "Optional section to focus on (e.g., 'programs', 'coverages', 'specialty_lines', 'business_types')"
                        }
                    }
                }
            },
            "instructions": "Use this tool to retrieve detailed information about excess and surplus insurance from the knowledge base. The tool uses semantic search to find relevant information about available programs, coverage types, business types, and specialty lines.",
            "class": "text_file_info_provider.TextFileInfoProvider"
        }
    ]
}
